import{_ as y,P as w,Q as m,a0 as p,T as e,S as i,aF as P,a2 as b,aD as _,aB as r,V as l,aC as n,U as u,a1 as Q,W as h,Z as S,R as U,X as C,at as v}from"./index.da022f16.js";import{Q as g}from"./QSpace.a3d21b38.js";import{Q as B,a as D,b as V,c as f}from"./QList.f7560650.js";import{Q as A}from"./QPage.dd58d8e9.js";import{P as F}from"./ProductCard.ee9b5eb1.js";import"./QImg.5abd0571.js";const N={components:{ProductCard:F},data(){return{search:"",products:[],categories:[],productsAll:[],client:{ci:"",name:""},recibido:"",saleDialog:!1,loading:!1}},created(){this.getProducts(),this.getCategories()},methods:{salePost(){this.loading=!0,this.$axios.post("sales",{client:this.client,products:this.$store.orders}).then(t=>{this.$store.orders=[],this.saleDialog=!1,this.$alert.success("Venta realizada")}).catch(t=>{this.$alert.error("Error al realizar la venta")}).finally(()=>{this.loading=!1})},textUpperCase(){this.client.name=this.client.name.toUpperCase()},searchClient(){if(console.log(this.client.ci),this.client.ci===""||this.client.ci===0||this.client.ci===null)return this.client.name="SN",!1;this.client.ci!=null&&this.$axios.get(`searchClient/${this.client.ci}`).then(t=>{var o;this.client.name=(o=t.data)==null?void 0:o.name})},pay(){if(this.$store.orders.length===0)return this.$alert.error("Debe agregar productos al carrito"),!1;this.recibido="",this.saleDialog=!0,this.client={ci:0,name:"SN"}},categoryClick(t){t.id===""?this.products=this.productsAll:this.products=this.productsAll.filter(o=>o.category_id===t.id)},productClick(t){const o=this.$store.orders.find(x=>x.id===t.id);o?o.cantidadSale+=1:this.$store.orders.push({id:t.id,name:t.name,price:t.price,cantidadSale:1})},getCategories(){this.$axios.get("categories").then(t=>{this.categories=t.data})},getProducts(){this.loading=!0,this.$axios.get("products").then(t=>{this.products=t.data,this.productsAll=t.data}).finally(()=>{this.loading=!1})},productFilter(t){t===""?this.products=this.productsAll:this.products=this.productsAll.filter(o=>o.name.toLowerCase().includes(t.toLowerCase()))}},computed:{categoryMoreAll(){return[{id:"",name:"Todo",icon:"fa-solid fa-globe"},...this.categories]}}},q={class:"row"},z={class:"col-12 col-md-8"},I={class:"row"},L={class:"col-12 col-md-4"},T=l("div",{class:"col-12 col-md-2"},null,-1),M=l("div",{class:"col-12 col-md-6 text-right"},null,-1),E={class:"col-12"},O={class:"col-12 col-md-4"},R=l("div",{class:"text-subtitle1 text-bold text-black"}," Carrito ",-1),W={class:"row"},X={class:"col-12"},Z={class:"row"},$={class:"col-6"},j={class:"col-6"},G={class:"col-12"},H=l("div",{class:"text-bold text-black"}," Total ",-1),J={class:"text-bold text-h5 text-red"},K={class:"col-12"},Y=l("div",{class:"text-h6 text-bold"}," Pago ",-1),ee={class:"text-bold text-center"},le={class:"row"},te={class:"col-12 col-md-4 text-red text-subtitle1 text-bold"},se={class:"col-12 col-md-4"},oe={class:"col-12 col-md-4 text-blue text-subtitle1 text-bold"},ie={key:0},ae={class:"row"},de={class:"col-12 col-md-4"},ce={class:"col-12 col-md-4"},re={class:"col-12 col-md-4 flex flex-center"};function ne(t,o,x,ue,a,c){const k=w("ProductCard");return m(),p(b,null,[e(A,{class:"bg-grey-3 q-pa-xs"},{default:i(()=>[e(_,null,{default:i(()=>[e(r,{class:"q-pa-xs"},{default:i(()=>[l("div",q,[l("div",z,[l("div",I,[l("div",L,[e(n,{modelValue:a.search,"onUpdate:modelValue":[o[0]||(o[0]=s=>a.search=s),c.productFilter],label:"Buscar",outlined:"",dense:"",clearable:"",loading:a.loading},null,8,["modelValue","onUpdate:modelValue","loading"])]),T,M,l("div",E,[e(k,{products:a.products,categories:c.categoryMoreAll,onProductClick:c.productClick,onCategoryClick:c.categoryClick},null,8,["products","categories","onProductClick","onCategoryClick"])])])]),l("div",O,[e(_,null,{default:i(()=>[e(r,{class:"q-pa-xs row items-center bg-yellow"},{default:i(()=>[R,e(g),e(u,{color:"red",label:"Limpiar Carrito",dense:"","no-caps":"",class:"text-bold",size:"10px",icon:"o_delete",onClick:o[1]||(o[1]=s=>t.$store.orders=[]),loading:a.loading},null,8,["loading"])]),_:1}),e(r,{class:"q-pa-xs"},{default:i(()=>[l("div",W,[l("div",X,[e(B,{bordered:"",dense:""},{default:i(()=>[(m(!0),p(b,null,Q(t.$store.orders,s=>(m(),U(D,{key:s.id},{default:i(()=>[e(V,null,{default:i(()=>[e(f,{class:"text-bold"},{default:i(()=>[C(h(s.name),1)]),_:2},1024),e(f,{caption:""},{default:i(()=>[l("div",Z,[l("div",$,[e(n,{modelValue:s.price,"onUpdate:modelValue":d=>s.price=d,dense:"",outlined:"",type:"number",step:"0.01"},{prepend:i(()=>[e(v,{name:"fa-solid fa-dollar-sign",size:"10px"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),l("div",j,[e(n,{modelValue:s.cantidadSale,"onUpdate:modelValue":d=>s.cantidadSale=d,dense:"",outlined:"",type:"number"},{prepend:i(()=>[e(v,{name:"fa-solid fa-shopping-cart",size:"10px"})]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024),e(V,{class:"text-right",side:""},{default:i(()=>[e(f,{class:"text-red text-bold text-h6"},{default:i(()=>[C(h((s.price*s.cantidadSale).toFixed(2))+" ",1),e(u,{dense:"",flat:"",rounded:"",icon:"delete",size:"10px",color:"red",onClick:d=>t.$store.orders.splice(t.$store.orders.indexOf(s),1)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),l("div",G,[e(r,{class:"q-pa-xs row items-center"},{default:i(()=>[H,e(g),l("div",J,h(t.$store.orders.reduce((s,d)=>s+d.price*d.cantidadSale,0).toFixed(2))+" Bs ",1)]),_:1})]),l("div",K,[e(r,{class:"q-pa-xs"},{default:i(()=>[e(u,{color:"indigo",label:"Pagar",dense:"","no-caps":"",class:"full-width text-bold",size:"lg",icon:"shopping_cart",onClick:c.pay,loading:a.loading},null,8,["onClick","loading"])]),_:1})])])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1}),e(P,{modelValue:a.saleDialog,"onUpdate:modelValue":o[6]||(o[6]=s=>a.saleDialog=s),persistent:""},{default:i(()=>[e(_,{style:{width:"700px","max-width":"90vh"}},{default:i(()=>[e(r,{class:"q-pa-xs row items-center"},{default:i(()=>[Y,e(g),e(u,{flat:"",dense:"",icon:"close",onClick:o[2]||(o[2]=s=>a.saleDialog=!1)})]),_:1}),e(r,{class:""},{default:i(()=>[l("div",ee,[l("div",le,[l("div",te," Total :"+h(t.$store.orders.reduce((s,d)=>s+d.price*d.cantidadSale,0).toFixed(2))+" Bs ",1),l("div",se,[e(n,{modelValue:a.recibido,"onUpdate:modelValue":o[3]||(o[3]=s=>a.recibido=s),label:"Monto recibido",outlined:"",dense:"",clearable:""},null,8,["modelValue"])]),l("div",oe,[a.recibido!==""?(m(),p("div",ie," Cambio :"+h((a.recibido-t.$store.orders.reduce((s,d)=>s+d.price*d.cantidadSale,0)).toFixed(2))+" Bs ",1)):S("",!0)])])])]),_:1}),e(r,null,{default:i(()=>[l("div",ae,[l("div",de,[e(n,{modelValue:a.client.ci,"onUpdate:modelValue":[o[4]||(o[4]=s=>a.client.ci=s),c.searchClient],label:"Numero",outlined:"",dense:"",clearable:"",debounce:"300"},null,8,["modelValue","onUpdate:modelValue"])]),l("div",ce,[e(n,{modelValue:a.client.name,"onUpdate:modelValue":[o[5]||(o[5]=s=>a.client.name=s),c.textUpperCase],label:"Nombre",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",re,[e(u,{color:"red-8",label:"Pagar",dense:"","no-caps":"",class:"text-bold full-width",icon:"shopping_cart",onClick:c.salePost,loading:a.loading},null,8,["onClick","loading"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var xe=y(N,[["render",ne]]);export{xe as default};
