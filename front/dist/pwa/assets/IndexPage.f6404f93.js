import{_ as N,P as R,Q as c,R as d,S as s,T as e,aB as b,V as a,aC as p,U as u,L as _,ar as C,X as g,a0 as E,a2 as B,a1 as U,aD as j,aE as I,aF as w,a3 as x,W as f,Z as k}from"./index.00f96b67.js";import{Q as G}from"./QSelect.8c2bb378.js";import{a as v,d as h,f as V}from"./format.a31ebe95.js";import{Q as A}from"./QBtnDropdown.b69638da.js";import{Q as P}from"./QMarkupTable.56e44f84.js";import{Q as O}from"./QSpace.2201e136.js";import{Q}from"./QForm.472b6621.js";import{Q as L}from"./QPage.1d220b4d.js";import{h as S}from"./moment.40bc58bf.js";import{C as M,E as Y}from"./Excel.b5f61cce.js";import{P as z}from"./index.aa4d44c1.js";import{I as F}from"./Imprimir.899c224e.js";import"./QList.8b57a4d5.js";import"./_commonjsHelpers.a26ce4be.js";const H={name:"IndexPage",components:{Card2Component:M},data(){return{mesa:"TODO",loading:!1,caja:[],dialogCaja:!1,fechaInicio:S().format("YYYY-MM-DD"),fechaFin:S().format("YYYY-MM-DD"),sales:[],ganancia1:{},ganancia2:{},ganancia3:{},ganancia4:{},egresoDialog:!1,egreso:{},provedores:[],chica:{},detalleGasto:[],cajaChica:{monto:0}}},mounted(){this.salesGet(),this.provedoresGet(),this.ultimaCajaGet()},methods:{excelExport(){let t=[{sheet:"productocementos",columns:[{label:"Fecha",value:"date"},{label:"Tipo",value:"type"},{label:"Descripcion",value:"descripcion"},{label:"Name",value:"name"},{label:"Total",value:"total"},{label:"Usuario",value:"user.name"},{label:"Mesa",value:"mesa"}],content:this.sales}];Y.export(t,"Reporte de Productos ladrillo")},printCajaClick(){var o;if(((o=this.cajaChica)==null?void 0:o.monto)==0)return this.$alert.error("Debe registrar Caja Chica"),!1;let t="",l="",y="";l="<table class='tab2'><tr><th>DESCRIPCION</th><th>PROVEEDOR</th><th>TOTAL</th></tr>",this.detalleGasto.forEach(r=>{y+="<tr><td>"+r.descripcion+"</td><td>"+r.name+"</td><td>"+r.total+"</td></tr>"}),l+=y,l+="<tr><td></td><td><b>TOTAL GASTOS:</b></td><th>"+this.egresos+`</th></tr>
      <tr><td></td><td><b>Caja Chica:</b></td><th>`+(parseFloat(this.cajaChica.monto)+parseFloat(this.egresos))+`</th></tr>
      <tr><td></td><td><b>Saldo:</b></td><th>`+this.cajaChica.monto+`</th></tr>
      </table>`,t=`<style>
    .imagen{
      width:60%
    }
    .titulo1 {
    text-align:center;
    font-weight:bold;
    font-size:14px;
    }
    .titulo2 {
    text-align:center;
    font-weight:bold;
    font-size:12px;
    }
    .tab1{
    width:100%;
    text-align:center;
    font-weight:bold;
    font-size:12px;
    }
    .tab2{
    width:100%;
    font-size:12px;
    border-collapse: collapse;
    }
    .tab2  th{
    border: .1px solid;
    }
    .numero{
    position:absolute; right:7px;
    font-weight:bold;
    font-size:30px;
    }
    .textocab{
    text-align:center;
    font-size:10px;
    }
    .pie{
    text-align:center;
    font-size:8px;}
    </style>
    <div style="padding: 0.0cm 0.3cm 0.0cm 0.3cm;  font-family:Verdana, sans-serif; position:relative; margin-top:0">

      <div style='text-align:center'><img class='imagen' src="logo2.png" width="70" ></div>
      <div class='titulo1'>

      </div>
      <div class='titulo2'>AV. TACNA ENTRE JAEN Y TOMAS FRIAS</div>
      <table class='tab1'><tr><td>`+this.fechaFin+`</td></tr></table><br>
      ${l}

    </div>`,document.getElementById("myelement").innerHTML=t,new z().print(document.getElementById("myelement"))},ultimaCajaGet(){this.$axios.post("/ultimaCaja",{fecha:this.fechaFin}).then(t=>{this.cajaChica=t.data}).catch(t=>{console.error(t),this.$alert.error("Error Caja")})},cajaPost(){this.loading=!0,this.$axios.post("/caja",this.chica).then(t=>{this.$alert.success("Caja  registrado"),this.ultimaCajaGet(),this.dialogCaja=!1}).catch(t=>{console.error(t),this.$alert.error("Error al registrar")}).finally(()=>{this.loading=!1})},cajaClick(){this.dialogCaja=!0,this.chica={}},getCaja(){this.loading=!0,this.$axios.post("/totalCaja",{ini:this.fechaInicio,fin:this.fechaFin}).then(t=>{this.caja=t.data}).catch(t=>{console.error(t),this.$alert.error("Error Caja")}).finally(()=>{this.loading=!1})},egresoPost(){this.loading=!0,this.$axios.post("/egresos",this.egreso).then(t=>{this.$alert.success("Egreso registrado"),F.recibo(t.data),this.ultimaCajaGet(),this.egresoDialog=!1}).catch(t=>{console.error(t),this.$alert.error("Error al registrar el egreso")}).finally(()=>{this.loading=!1})},provedoresGet(){this.$axios.get("/provedores").then(t=>{this.provedores=t.data}).catch(t=>{console.error(t)})},egreseClick(){this.egresoDialog=!0,this.egreso={total:"",provedor_id:"",descripcion:""}},reimprimir(t){F.recibo(t)},anular(t){this.$alert.confirm("\xBFEst\xE1 seguro de anular la venta?").onOk(()=>{this.$axios.post("saleAnular",{id:t.id}).then(l=>{this.$alert.success("Venta anulada"),this.salesGet()}).catch(l=>{console.error(l),this.$alert.error("Error al anular la venta")})})},salesGet(){this.loading=!0,this.$axios.post("/reportVenta",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,mesa:this.mesa}).then(t=>{this.detalleGasto=[],this.sales=t.data,this.sales.forEach(l=>{l.type==="EGRESO"&&l.status!=="ANULADO"&&this.detalleGasto.push(l)}),this.gananciaGet(),this.ultimaCajaGet()}).catch(t=>{console.error(t)}).finally(()=>{this.loading=!1})},gananciaGet(){this.loading=!0,this.$axios.post("/reportGanancia",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,mesa:this.mesa}).then(t=>{console.log(t.data),this.ganancia1=t.data[0],this.ganancia2=t.data[1],this.ganancia3=t.data[2],this.ganancia4=t.data[3]}).catch(t=>{console.error(t)}).finally(()=>{this.loading=!1})}},computed:{ingresos(){let t=0;return this.sales.forEach(l=>{l.type==="INGRESO"&&l.status!=="ANULADO"&&(t+=l.total)}),t},egresos(){let t=0;return this.sales.forEach(l=>{l.type==="EGRESO"&&l.status!=="ANULADO"&&(t+=l.total)}),t},totalCaja(){let t=0;return this.caja.forEach(l=>{t=t+parseFloat(l.monto)}),t},totalGasto(){return this.totalCaja-this.egresos}}},J={class:"row"},W={class:"col-12 col-md-3 q-pa-xs"},X={class:"col-12 col-md-3 q-pa-xs"},Z={class:"col-12 col-md-2 q-pa-xs"},K={class:"col-12 col-md-2"},$={class:"col-12 col-md-2 text-right"},ee={class:"col-12 col-md-4 text-right"},te={class:"col-12 col-md-4 text-right"},le={class:"col-12 col-md-4 text-right"},oe={class:"row"},ae={class:"col-12 col-md-4 q-pa-xs"},se={class:"col-12 col-md-4 q-pa-xs"},ie={class:"col-12 col-md-4 q-pa-xs"},ne={class:"row"},re={class:"col-xs-12 col-md-3 q-pa-xs"},ce={class:"col-xs-12 col-md-3 q-pa-xs"},de={class:"col-xs-12 col-md-3 q-pa-xs"},ue={class:"col-xs-12 col-md-3 q-pa-xs"},he={class:"row"},me={class:"col-12"},pe=a("thead",{class:"bg-black text-white"},[a("tr",null,[a("th",null,"Opciones"),a("th",null,"Fecha"),a("th",null,"Tipo"),a("th",null,"Descripcion"),a("th",null,"Name"),a("th",null,"Total"),a("th",null,"Usuario")])],-1),ge={key:0},fe={class:"text-caption",style:{"max-width":"400px","white-space":"normal","overflow-wrap":"break-word","line-height":"0.9"}},be={class:"text-bold"},_e={key:1},Ce=a("tr",null,[a("td",{colspan:"7",class:"text-center"},"No hay ventas")],-1),xe=[Ce],ve=a("div",{class:"text-h6"},"Egreso",-1),Ee=a("div",{class:"text-h6"},"Ingreso Caja Chica Dia",-1),ke=a("div",{id:"myelement",class:"hidden"},null,-1);function ye(t,l,y,T,o,r){const m=R("card2-component");return c(),d(L,{class:"q-pa-md bg-grey-3"},{default:s(()=>[e(j,null,{default:s(()=>[e(b,{class:"q-pa-xs"},{default:s(()=>{var i;return[a("div",J,[a("div",W,[e(p,{modelValue:o.fechaInicio,"onUpdate:modelValue":l[0]||(l[0]=n=>o.fechaInicio=n),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),a("div",X,[e(p,{modelValue:o.fechaFin,"onUpdate:modelValue":l[1]||(l[1]=n=>o.fechaFin=n),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),a("div",Z,[e(G,{modelValue:o.mesa,"onUpdate:modelValue":l[2]||(l[2]=n=>o.mesa=n),label:"Mesa",outlined:"",dense:"",options:["TODO","MESA","LLEVAR","DELIVERY","PEDIDOS YA"]},null,8,["modelValue"])]),a("div",K,[e(u,{label:"Buscar",color:"indigo",onClick:r.salesGet,loading:o.loading,"no-caps":"",icon:"search",class:"text-bold"},null,8,["onClick","loading"])]),a("div",$,[e(A,{label:"Exportar","no-caps":"",color:"green","auto-close":""},{default:s(()=>[_((c(),d(v,{clickable:"",onClick:r.excelExport},{default:s(()=>[e(h,{avatar:""},{default:s(()=>[e(C,{name:"save_alt"})]),_:1}),e(h,null,{default:s(()=>[g("Excel")]),_:1})]),_:1},8,["onClick"])),[[x]]),_((c(),d(v,{clickable:"",onClick:r.printCajaClick},{default:s(()=>[e(h,{avatar:""},{default:s(()=>[e(C,{name:"print"})]),_:1}),e(h,null,{default:s(()=>[g("Imprimir Caja")]),_:1})]),_:1},8,["onClick"])),[[x]]),_((c(),d(v,{clickable:"",onClick:r.salesGet},{default:s(()=>[e(h,{avatar:""},{default:s(()=>[e(C,{name:"refresh"})]),_:1}),e(h,null,{default:s(()=>[g("Recargar")]),_:1})]),_:1},8,["onClick"])),[[x]])]),_:1})]),a("div",ee,[e(u,{label:"Caja Chica",color:"indigo",onClick:r.cajaClick,loading:o.loading,"no-caps":"",icon:"attach_money",class:"text-bold"},null,8,["onClick","loading"])]),a("div",te,[e(u,{label:"Egreso",color:"red",onClick:r.egreseClick,loading:o.loading,"no-caps":"",icon:"add_circle_outline",class:"text-bold"},null,8,["onClick","loading"])]),a("div",le,[e(u,{color:"info",onClick:r.printCajaClick,loading:o.loading,"no-caps":"",icon:"print",class:"text-bold"},null,8,["onClick","loading"])])]),a("div",oe,[a("div",ae,[e(m,{title:"Ingresos",subtitle:r.ingresos+" Bs.",icon:"trending_up",color:"green"},null,8,["subtitle"])]),a("div",se,[e(m,{title:"Egresos",subtitle:r.egresos+" Bs.",icon:"trending_down",color:"red"},null,8,["subtitle"])]),a("div",ie,[e(m,{title:"Caja Chica",subtitle:((i=o.cajaChica)==null?void 0:i.monto)+" Bs.",icon:"fa-solid fa-cash-register",color:"blue"},null,8,["subtitle"])])]),a("div",ne,[a("div",re,[e(m,{title:"EFECTIVO",subtitle:o.ganancia1.total+" Bs.",icon:"point_of_sale",color:"amber",dense:""},null,8,["subtitle"])]),a("div",ce,[e(m,{title:"TARJETA",subtitle:o.ganancia2.total+" Bs.",icon:"credit_card",color:"indigo"},null,8,["subtitle"])]),a("div",de,[e(m,{title:"ONLINE",subtitle:o.ganancia3.total+" Bs.",icon:"shopping_cart",color:"cyan"},null,8,["subtitle"])]),a("div",ue,[e(m,{title:"QR",subtitle:o.ganancia4.total+" Bs.",icon:"qr_code_scanner",color:"deep-orange"},null,8,["subtitle"])])]),a("div",he,[a("div",me,[e(P,{dense:"","wrap-cells":""},{default:s(()=>[pe,o.sales.length>0?(c(),E("tbody",ge,[(c(!0),E(B,null,U(o.sales,n=>{var D;return c(),E("tr",{key:n.id},[a("td",null,[g(f(n.numero)+" ",1),n.status!=="ANULADO"?(c(),d(A,{key:0,label:"Opciones","no-caps":"",size:"10px",dense:"",color:n.type==="EGRESO"?"red":"green","auto-close":""},{default:s(()=>[_((c(),d(v,{clickable:"",onClick:q=>r.reimprimir(n)},{default:s(()=>[e(h,{avatar:""},{default:s(()=>[e(C,{name:"print"})]),_:1}),e(h,null,{default:s(()=>[g("Reimprimir")]),_:1})]),_:2},1032,["onClick"])),[[x]]),_((c(),d(v,{clickable:"",onClick:q=>r.anular(n)},{default:s(()=>[e(h,{avatar:""},{default:s(()=>[e(C,{name:"cancel"})]),_:1}),e(h,null,{default:s(()=>[g("Anular")]),_:1})]),_:2},1032,["onClick"])),[[x]])]),_:2},1032,["color"])):k("",!0),n.status==="ANULADO"?(c(),d(V,{key:1,color:"red","text-color":"white",label:"Anulado",size:"12px",dense:""})):k("",!0)]),a("td",null,f(t.$filters.formatdMYHi(n.date+" "+n.time)),1),a("td",null,[n.type==="INGRESO"?(c(),d(V,{key:0,color:"green","text-color":"white",label:"Ingreso",size:"12px",dense:""})):k("",!0),n.type==="EGRESO"?(c(),d(V,{key:1,color:"red","text-color":"white",label:"Egreso",size:"12px",dense:""})):k("",!0)]),a("td",null,[a("div",fe,f(n.descripcion),1)]),a("td",null,f(n.name),1),a("td",be,f(n.total)+" Bs",1),a("td",null,f((D=n.user)==null?void 0:D.name),1)])}),128))])):(c(),E("tbody",_e,xe))]),_:1})])])]}),_:1})]),_:1}),e(w,{modelValue:o.egresoDialog,"onUpdate:modelValue":l[8]||(l[8]=i=>o.egresoDialog=i),persistent:""},{default:s(()=>[e(j,null,{default:s(()=>[e(b,{class:"row items-center q-pb-none"},{default:s(()=>[ve,e(O),e(u,{flat:"",round:"",dense:"",icon:"close",onClick:l[3]||(l[3]=i=>o.egresoDialog=!1)})]),_:1}),e(b,null,{default:s(()=>[e(Q,{onSubmit:r.egresoPost},{default:s(()=>[e(p,{modelValue:o.egreso.total,"onUpdate:modelValue":l[4]||(l[4]=i=>o.egreso.total=i),label:"Total",type:"number",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),e(G,{modelValue:o.egreso.provedor_id,"onUpdate:modelValue":l[5]||(l[5]=i=>o.egreso.provedor_id=i),label:"Provedor",outlined:"",dense:"",options:o.provedores,"option-value":"id","option-label":"name",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","options","rules"]),e(p,{modelValue:o.egreso.descripcion,"onUpdate:modelValue":l[6]||(l[6]=i=>o.egreso.descripcion=i),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"]),e(I,{align:"right"},{default:s(()=>[e(u,{label:"Cancelar",color:"red",onClick:l[7]||(l[7]=i=>o.egresoDialog=!1),"no-caps":"",icon:"close",loading:o.loading},null,8,["loading"]),e(u,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(w,{modelValue:o.dialogCaja,"onUpdate:modelValue":l[13]||(l[13]=i=>o.dialogCaja=i),persistent:""},{default:s(()=>[e(j,null,{default:s(()=>[e(b,{class:"row items-center q-pb-none"},{default:s(()=>[Ee,e(O),e(u,{flat:"",round:"",dense:"",icon:"close",onClick:l[9]||(l[9]=i=>o.dialogCaja=!1)})]),_:1}),e(b,null,{default:s(()=>[e(Q,{onSubmit:r.cajaPost},{default:s(()=>[e(p,{modelValue:o.chica.monto,"onUpdate:modelValue":l[10]||(l[10]=i=>o.chica.monto=i),label:"Monto",type:"number",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),e(p,{modelValue:o.chica.descripcion,"onUpdate:modelValue":l[11]||(l[11]=i=>o.chica.descripcion=i),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[i=>!!i||"Campo requerido"]},null,8,["modelValue","rules"]),e(I,{align:"right"},{default:s(()=>[e(u,{label:"Cancelar",color:"red",onClick:l[12]||(l[12]=i=>o.dialogCaja=!1),"no-caps":"",icon:"close",loading:o.loading},null,8,["loading"]),e(u,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),ke]),_:1})}var Re=N(H,[["render",ye]]);export{Re as default};
