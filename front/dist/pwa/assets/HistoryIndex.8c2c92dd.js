import{Q as A}from"./QSelect.8c2bb378.js";import{_ as C,Q as l,R as i,S as m,T as d,aB as V,V as t,aC as g,U as x,a0 as f,a1 as q,a2 as y,W as n,aD as v}from"./index.00f96b67.js";import{f as c}from"./format.a31ebe95.js";import{Q as k}from"./QMarkupTable.56e44f84.js";import{Q}from"./QPage.1d220b4d.js";import{h as b}from"./moment.40bc58bf.js";const E={name:"DiariesIndex",data(){return{date:b().format("YYYY-MM-DD"),buys:[],deregistrations:[],loading:!1,insumos:[],insumo:"",fechaInicio:b().format("YYYY-MM-DD"),fechaFin:b().format("YYYY-MM-DD")}},mounted(){this.buyGet(),this.insumosGet()},methods:{insumosGet(){this.insumos=[],this.insumos.push({label:"Todos",value:""}),this.$axios.get("insumos").then(s=>{s.data.forEach(o=>{o.status==="ACTIVE"&&this.insumos.push({label:o.name,value:o.id})})}).catch(s=>{this.$alert.error(s.response.data.message)})},deregistrationAnular(s){this.$alert.confirm("\xBFEst\xE1 seguro de anular la baja?").onOk(()=>{this.$axios.put(`deregistrationsAnular/${s}`).then(o=>{const _=this.deregistrations.find(p=>p.id===s);_.status="INACTIVE",this.$alert.success("Baja anulada")}).catch(o=>{this.$alert.error(o.response.data.message)})})},buyAnular(s){this.$alert.confirm("\xBFEst\xE1 seguro de anular la compra?").onOk(()=>{this.$axios.put(`buysAnular/${s}`).then(o=>{const _=this.buys.find(p=>p.id===s);_.status="INACTIVE",this.$alert.success("Compra anulada")}).catch(o=>{this.$alert.error(o.response.data.message)})})},buyGet(){this.loading=!0,this.$axios.get("buys",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin,insumo:this.insumo}}).then(s=>{this.buys=s.data.buys,this.deregistrations=s.data.deregistrations}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})}},computed:{totalQuantity(){let s=0;return this.buys.length===0?s:(this.buys.forEach(o=>{s+=parseFloat(o.quantity)}),s.toFixed(2))},totalQuantityDeregistrations(){let s=0;return this.deregistrations.length===0?s:(this.deregistrations.forEach(o=>{s+=parseFloat(o.quantity)}),s.toFixed(2))}}},F={class:"row"},T={class:"col-12 col-md-2 text-center"},Y={class:"col-12 col-md-2"},w={class:"col-12 col-md-2"},D={class:"col-12 col-md-2 text-center"},M={class:"row"},B={class:"col-6"},z=t("thead",null,[t("tr",null,[t("td",{colspan:"8",class:"text-center text-bold"},"COMPRAS")]),t("tr",{class:"bg-black text-white"},[t("td",null,"Opcion"),t("td",null,"Insumo"),t("td",null,"Usuario"),t("td",null,"Cantidad"),t("td",null,"Precio"),t("td",null,"Total"),t("td",null,"Estado"),t("td",null,"Fecha")])],-1),S={class:"q-pa-none q-ma-none"},U={class:"q-pa-none q-ma-none"},G={class:"q-pa-none q-ma-none"},O={class:"q-pa-none q-ma-none"},N={class:"q-pa-none q-ma-none"},P={class:"q-pa-none q-ma-none"},$={class:"q-pa-none q-ma-none"},H={class:"q-pa-none q-ma-none"},j=t("td",{colspan:"3",class:"text-right text-bold"},"Total",-1),R={class:"text-bold"},J=t("td",{class:"text-bold"},null,-1),L=t("td",{class:"text-bold"},null,-1),W=t("td",{colspan:"2"},null,-1),K={class:"col-6"},X=t("thead",null,[t("tr",null,[t("td",{colspan:"8",class:"text-center text-bold"},"BAJAS")]),t("tr",{class:"bg-black text-white"},[t("td",null,"Opcion"),t("td",null,"Insumo"),t("td",null,"Usuario"),t("td",null,"Cantidad"),t("td",null,"Precio"),t("td",null,"Total"),t("td",null,"Estado"),t("td",null,"Fecha")])],-1),Z={class:"q-pa-none q-ma-none"},tt={class:"q-pa-none q-ma-none"},et={class:"q-pa-none q-ma-none"},st={class:"q-pa-none q-ma-none"},ot={class:"q-pa-none q-ma-none"},nt={class:"q-pa-none q-ma-none"},at={class:"q-pa-none q-ma-none"},lt={class:"q-pa-none q-ma-none"},it=t("td",{colspan:"3",class:"text-right text-bold"},"Total",-1),dt={class:"text-bold"},ct=t("td",{class:"text-bold"},null,-1),rt=t("td",{class:"text-bold"},null,-1),ut=t("td",{colspan:"2"},null,-1);function ht(s,o,_,p,a,r){return l(),i(Q,{class:"bg-grey-3 q-pa-xs"},{default:m(()=>[d(v,null,{default:m(()=>[d(V,{class:"q-pa-xs"},{default:m(()=>[t("div",F,[t("div",T,[d(A,{modelValue:a.insumo,"onUpdate:modelValue":o[0]||(o[0]=e=>a.insumo=e),options:a.insumos,label:"Insumo",outlined:"",dense:"",loading:a.loading,"emit-value":"","map-options":""},null,8,["modelValue","options","loading"])]),t("div",Y,[d(g,{modelValue:a.fechaInicio,"onUpdate:modelValue":o[1]||(o[1]=e=>a.fechaInicio=e),type:"date",label:"Fecha Inicio",outlined:"",dense:"",loading:a.loading},null,8,["modelValue","loading"])]),t("div",w,[d(g,{modelValue:a.fechaFin,"onUpdate:modelValue":o[2]||(o[2]=e=>a.fechaFin=e),type:"date",label:"Fecha Fin",outlined:"",dense:"",loading:a.loading},null,8,["modelValue","loading"])]),t("div",D,[d(x,{onClick:r.buyGet,class:"text-bold",label:"Buscar",color:"primary",icon:"search","no-caps":"",loading:a.loading},null,8,["onClick","loading"])])]),t("div",M,[t("div",B,[d(k,{dense:"","wrap-cells":"",bordered:""},{default:m(()=>[z,t("tbody",null,[(l(!0),f(y,null,q(a.buys,e=>{var u,h;return l(),f("tr",{key:e.id},[t("td",S,[e.status==="ACTIVE"?(l(),i(x,{key:0,dense:"",size:"10px",color:"primary",onClick:I=>r.buyAnular(e.id),label:"Anular",icon:"cancel","no-caps":""},null,8,["onClick"])):(l(),i(c,{key:1,color:"grey","text-color":"white",label:"Anulado",dense:"",size:"10px"}))]),t("td",U,n((u=e.insumo)==null?void 0:u.name),1),t("td",G,n((h=e.user)==null?void 0:h.name),1),t("td",O,n(e.quantity),1),t("td",N,n(e.price),1),t("td",P,n(e.total),1),t("td",$,[e.status==="ACTIVE"?(l(),i(c,{key:0,color:"green","text-color":"white",label:"Activo",dense:"",size:"10px"})):(l(),i(c,{key:1,color:"red","text-color":"white",label:"Inactivo",dense:"",size:"10px"}))]),t("td",H,n(s.$filters.formatdMYHi(e.date+" "+e.time)),1)])}),128))]),t("tfoot",null,[t("tr",null,[j,t("td",R,n(r.totalQuantity),1),J,L,W])])]),_:1})]),t("div",K,[d(k,{dense:"","wrap-cells":"",bordered:""},{default:m(()=>[X,t("tbody",null,[(l(!0),f(y,null,q(a.deregistrations,e=>{var u,h;return l(),f("tr",{key:e.id},[t("td",Z,[e.status==="ACTIVE"?(l(),i(x,{key:0,dense:"",size:"10px",color:"primary",onClick:I=>r.deregistrationAnular(e.id),label:"Anular",icon:"cancel","no-caps":""},null,8,["onClick"])):(l(),i(c,{key:1,color:"grey","text-color":"white",label:"Anulado",dense:"",size:"10px"}))]),t("td",tt,n((u=e.insumo)==null?void 0:u.name),1),t("td",et,n((h=e.user)==null?void 0:h.name),1),t("td",st,n(e.quantity),1),t("td",ot,n(e.price),1),t("td",nt,n(e.total),1),t("td",at,[e.status==="ACTIVE"?(l(),i(c,{key:0,color:"green","text-color":"white",label:"Activo",dense:"",size:"10px"})):(l(),i(c,{key:1,color:"red","text-color":"white",label:"Inactivo",dense:"",size:"10px"}))]),t("td",lt,n(s.$filters.formatdMYHi(e.date+" "+e.time)),1)])}),128))]),t("tfoot",null,[t("tr",null,[it,t("td",dt,n(r.totalQuantityDeregistrations),1),ct,rt,ut])])]),_:1})])])]),_:1})]),_:1})]),_:1})}var gt=C(E,[["render",ht]]);export{gt as default};
