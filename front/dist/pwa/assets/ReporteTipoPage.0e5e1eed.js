import{_,P as x,Q as n,R as y,S as b,V as e,T as i,aC as h,U as m,a0 as d,ar as v,W as l,a1 as k,a2 as F}from"./index.00f96b67.js";import{Q as R}from"./QPage.1d220b4d.js";import{h as f}from"./moment.40bc58bf.js";import{m as I}from"./vue3-apexcharts.d5a074d8.js";import{P as D}from"./index.aa4d44c1.js";const S={name:"ReporteTipoPage",components:{apexchart:I},data(){return{fechaInicio:f().startOf("month").format("YYYY-MM-DD"),fechaFin:f().endOf("month").format("YYYY-MM-DD"),loading:!1,chartSeries:[],reporteData:[],chartOptions:{chart:{id:"reporte-tipo",toolbar:{show:!0}},xaxis:{categories:[]},dataLabels:{enabled:!0},legend:{show:!1},plotOptions:{bar:{distributed:!0}},colors:["#43a047","#1e88e5","#fbc02d","#e53935"]}}},methods:{imprimirReporte(){const s=document.querySelector("#print-reporte");if(!s){this.$alert.error("No se encontr\xF3 el reporte para imprimir.");return}const o=new D,c=`
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          h3 { margin-bottom: 0; text-align: center }
          p { margin-top: 4px; font-size: 14px; text-align: center }
          table { border-collapse: collapse; font-size: 14px; width: 100% }
          th, td { padding: 6px; border: 1px solid #000; }
          th { background: #f0f0f0; }
          td:last-child { text-align: right; }
        </style>
      `+s.innerHTML,t=document.createRange().createContextualFragment(c);o.print(t)},async generarReporte(){this.loading=!0;try{const o=(await this.$axios.post("/reportTipo",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin})).data;this.reporteData=[...o].sort((r,c)=>c.total-r.total),this.chartOptions.xaxis.categories=o.map(r=>r.mesa),this.chartSeries=[{name:"Ganancia",data:o.map(r=>r.total)}]}catch(s){this.$alert.error("Error al generar el reporte",s.message||"Error desconocido")}finally{this.loading=!1}}}},C=e("div",{class:"text-h5 text-primary q-mb-md"},"Reporte por Tipo de Movimiento",-1),V={class:"row q-col-gutter-md q-mb-md"},q={class:"col-12 col-md-4"},w={class:"col-12 col-md-4"},M={class:"col-12 col-md-2 flex items-center"},O={class:"col-12 col-md-2 flex items-center"},P={key:0,id:"grafico-reporte"},T={key:1,class:"text-center q-mt-md"},Y=e("div",{class:"text-caption text-grey"},"Sin datos para mostrar",-1),E={id:"print-reporte",class:"q-pa-md",style:{display:"none"}},B={class:"text-center"},Q=e("h3",null,"REPORTE DE GANANCIAS POR MESA",-1),A={border:"1",cellspacing:"0",cellpadding:"4",width:"100%"},N=e("thead",null,[e("tr",{style:{background:"#f0f0f0"}},[e("th",null,"#"),e("th",null,"Mesa"),e("th",null,"Total (Bs)")])],-1),z={style:{"text-align":"right"}};function G(s,o,r,c,t,p){const u=x("apexchart");return n(),y(R,{class:"q-pa-md bg-grey-1"},{default:b(()=>[C,e("div",V,[e("div",q,[i(h,{modelValue:t.fechaInicio,"onUpdate:modelValue":o[0]||(o[0]=a=>t.fechaInicio=a),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",w,[i(h,{modelValue:t.fechaFin,"onUpdate:modelValue":o[1]||(o[1]=a=>t.fechaFin=a),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",M,[i(m,{label:"Generar",color:"primary",icon:"insights",onClick:p.generarReporte,loading:t.loading,"no-caps":""},null,8,["onClick","loading"])]),e("div",O,[i(m,{label:"Imprimir",color:"secondary",icon:"print",class:"q-ml-sm",onClick:p.imprimirReporte,"no-caps":""},null,8,["onClick"])])]),t.chartSeries.length?(n(),d("div",P,[i(u,{type:"bar",height:"400",options:t.chartOptions,series:t.chartSeries},null,8,["options","series"])])):(n(),d("div",T,[i(v,{name:"bar_chart",size:"56px",color:"grey"}),Y])),e("div",E,[e("div",B,[Q,e("p",null,"Del "+l(t.fechaInicio)+" al "+l(t.fechaFin),1)]),e("table",A,[N,e("tbody",null,[(n(!0),d(F,null,k(t.reporteData,(a,g)=>(n(),d("tr",{key:a.mesa},[e("td",null,l(g+1),1),e("td",null,l(a.mesa),1),e("td",z,l(a.total.toFixed(2)),1)]))),128))])])])]),_:1})}var J=_(S,[["render",G]]);export{J as default};
