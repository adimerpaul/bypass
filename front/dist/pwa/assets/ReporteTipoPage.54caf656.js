import{_,P as x,Q as l,R as y,S as b,V as e,T as i,aC as m,U as h,a0 as d,ar as v,W as n,a1 as k,a2 as D}from"./index.42000889.js";import{Q as F}from"./QPage.02ff451e.js";import{h as f}from"./moment.40bc58bf.js";import{m as I}from"./vue3-apexcharts.875450c1.js";import{P as R}from"./index.aa4d44c1.js";const C={name:"ReporteTipoPage",components:{apexchart:I},data(){return{fechaInicio:f().startOf("month").format("YYYY-MM-DD"),fechaFin:f().endOf("month").format("YYYY-MM-DD"),loading:!1,chartSeries:[],reporteData:[],chartOptions:{chart:{id:"reporte-tipo",toolbar:{show:!0}},xaxis:{categories:[]},dataLabels:{enabled:!0,formatter:function(s,t){return t.w.config.series[0].data[t.dataPointIndex].customData}},legend:{show:!1},plotOptions:{bar:{distributed:!0}},colors:["#43a047","#1e88e5","#fbc02d","#e53935"]}}},methods:{imprimirReporte(){const s=document.querySelector("#print-reporte");if(!s){this.$alert.error("No se encontr\xF3 el reporte para imprimir.");return}const t=new R,c=`
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          h3 { margin-bottom: 0; text-align: center }
          p { margin-top: 4px; font-size: 14px; text-align: center }
          table { border-collapse: collapse; font-size: 14px; width: 100% }
          th, td { padding: 6px; border: 1px solid #000; }
          th { background: #f0f0f0; }
          td:last-child { text-align: right; }
        </style>
      `+s.innerHTML,o=document.createRange().createContextualFragment(c);t.print(o)},async generarReporte(){this.loading=!0;try{const t=(await this.$axios.post("/reportTipo",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin})).data;this.reporteData=[...t].sort((a,c)=>c.total-a.total),this.chartOptions.xaxis.categories=t.map(a=>a.mesa),this.chartSeries=[{name:"Ganancia",data:t.map(a=>({x:a.mesa,y:a.total,fillColor:"#43a047",customData:`${a.total} Bs (${a.cantidad})`}))}]}catch(s){this.$alert.error("Error al generar el reporte",s.message||"Error desconocido")}finally{this.loading=!1}}}},S=e("div",{class:"text-h5 text-primary q-mb-md"},"Reporte por Tipo de Movimiento",-1),w={class:"row q-col-gutter-md q-mb-md"},P={class:"col-12 col-md-4"},V={class:"col-12 col-md-4"},q={class:"col-12 col-md-2 flex items-center"},M={class:"col-12 col-md-2 flex items-center"},O={key:0,id:"grafico-reporte"},T={key:1,class:"text-center q-mt-md"},Y=e("div",{class:"text-caption text-grey"},"Sin datos para mostrar",-1),B={id:"print-reporte",class:"q-pa-md",style:{display:"none"}},E={class:"text-center"},Q=e("h3",null,"REPORTE DE GANANCIAS POR MESA",-1),A={border:"1",cellspacing:"0",cellpadding:"4",width:"100%"},N=e("thead",null,[e("tr",{style:{background:"#f0f0f0"}},[e("th",null,"#"),e("th",null,"Mesa"),e("th",null,"Cantidad"),e("th",null,"Total (Bs)")])],-1),z={style:{"text-align":"right"}};function G(s,t,a,c,o,p){const u=x("apexchart");return l(),y(F,{class:"q-pa-md bg-grey-1"},{default:b(()=>[S,e("div",w,[e("div",P,[i(m,{modelValue:o.fechaInicio,"onUpdate:modelValue":t[0]||(t[0]=r=>o.fechaInicio=r),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",V,[i(m,{modelValue:o.fechaFin,"onUpdate:modelValue":t[1]||(t[1]=r=>o.fechaFin=r),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),e("div",q,[i(h,{label:"Generar",color:"primary",icon:"insights",onClick:p.generarReporte,loading:o.loading,"no-caps":""},null,8,["onClick","loading"])]),e("div",M,[i(h,{label:"Imprimir",color:"secondary",icon:"print",class:"q-ml-sm",onClick:p.imprimirReporte,"no-caps":""},null,8,["onClick"])])]),o.chartSeries.length?(l(),d("div",O,[i(u,{type:"bar",height:"400",options:o.chartOptions,series:o.chartSeries},null,8,["options","series"])])):(l(),d("div",T,[i(v,{name:"bar_chart",size:"56px",color:"grey"}),Y])),e("div",B,[e("div",E,[Q,e("p",null,"Del "+n(o.fechaInicio)+" al "+n(o.fechaFin),1)]),e("table",A,[N,e("tbody",null,[(l(!0),d(D,null,k(o.reporteData,(r,g)=>(l(),d("tr",{key:r.mesa},[e("td",null,n(g+1),1),e("td",null,n(r.mesa),1),e("td",null,n(r.cantidad),1),e("td",z,n(r.total.toFixed(2)),1)]))),128))])])])]),_:1})}var J=_(C,[["render",G]]);export{J as default};
