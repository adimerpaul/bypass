import{_ as F,P as B,Q as n,R as u,S as i,T as o,aB as m,V as a,aC as h,U as c,a0 as p,a2 as S,a1 as U,aD as b,aE as k,aF as y,X as C,W as g,L as V,at as E,a3 as j,Z as f}from"./index.e0314f2c.js";import{d as D,e as _}from"./format.bc297412.js";import{Q as A}from"./QBtnDropdown.9f97b36e.js";import{Q as v}from"./QChip.1061cc99.js";import{Q as N}from"./QMarkupTable.975e911b.js";import{Q as I,a as O}from"./QSelect.523b4154.js";import{Q}from"./QForm.5c6ba300.js";import{Q as R}from"./QPage.d109870e.js";import{h as w}from"./moment.40bc58bf.js";import{C as P}from"./Card2Component.838dd6bc.js";import"./index.aa4d44c1.js";import{I as G}from"./Imprimir.ed7b5a2c.js";const T={name:"IndexPage",components:{Card2Component:P},data(){return{loading:!1,caja:[],dialogCaja:!1,fechaInicio:w().format("YYYY-MM-DD"),fechaFin:w().format("YYYY-MM-DD"),sales:[],ganancia1:{},ganancia2:{},ganancia3:{},ganancia4:{},egresoDialog:!1,egreso:{},provedores:[],chica:{}}},mounted(){this.salesGet(),this.provedoresGet()},methods:{cajaPost(){this.loading=!0,this.$axios.post("/caja",this.chica).then(l=>{this.$alert.success("Caja  registrado"),this.getCaja(),this.dialogCaja=!1}).catch(l=>{console.error(l),this.$alert.error("Error al registrar")}).finally(()=>{this.loading=!1})},cajaClick(){this.dialogCaja=!0,this.chica={}},getCaja(){this.loading=!0,this.$axios.post("/totalCaja",{ini:this.fechaInicio,fin:this.fechaFin}).then(l=>{this.caja=l.data}).catch(l=>{console.error(l),this.$alert.error("Error Caja")}).finally(()=>{this.loading=!1})},egresoPost(){this.loading=!0,this.$axios.post("/egresos",this.egreso).then(l=>{this.$alert.success("Egreso registrado"),G.recibo(l.data),this.salesGet(),this.egresoDialog=!1}).catch(l=>{console.error(l),this.$alert.error("Error al registrar el egreso")}).finally(()=>{this.loading=!1})},provedoresGet(){this.$axios.get("/provedores").then(l=>{this.provedores=l.data}).catch(l=>{console.error(l)})},egreseClick(){this.egresoDialog=!0,this.egreso={total:"",provedor_id:"",descripcion:""}},reimprimir(l){G.recibo(l)},anular(l){this.$alert.confirm("\xBFEst\xE1 seguro de anular la venta?").onOk(()=>{this.$axios.post("saleAnular",{id:l.id}).then(t=>{this.$alert.success("Venta anulada"),this.salesGet()}).catch(t=>{console.error(t),this.$alert.error("Error al anular la venta")})})},salesGet(){this.loading=!0,this.$axios.get("/sales",{params:{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}}).then(l=>{this.sales=l.data,this.gananciaGet()}).catch(l=>{console.error(l)}).finally(()=>{this.loading=!1})},gananciaGet(){this.loading=!0,this.$axios.post("/reportGanancia",{fechaInicio:this.fechaInicio,fechaFin:this.fechaFin}).then(l=>{console.log(l.data),this.ganancia1=l.data[0],this.ganancia2=l.data[1],this.ganancia3=l.data[2],this.ganancia4=l.data[3]}).catch(l=>{console.error(l)}).finally(()=>{this.loading=!1})}},computed:{ingresos(){let l=0;return this.sales.forEach(t=>{t.type==="INGRESO"&&t.status!=="ANULADO"&&(l+=t.total)}),l},egresos(){let l=0;return this.sales.forEach(t=>{t.type==="EGRESO"&&t.status!=="ANULADO"&&(l+=t.total)}),l},totalCaja(){let l=0;return this.caja.forEach(t=>{l=l+parseFloat(t.monto)}),l},totalGasto(){return this.totalCaja-this.egresos}}},Y={class:"row"},L={class:"col-12 col-md-2"},M={class:"col-12 col-md-2"},z={class:"col-12 col-md-2 text-center"},H={class:"col-12 col-md-6 text-right"},J={class:"col-12 col-md-4 q-pa-xs"},W={class:"col-12 col-md-4 q-pa-xs"},X={class:"col-12 col-md-4 q-pa-xs"},Z={class:"row"},K={class:"col-xs-12 col-md-3 q-pa-xs"},$={class:"col-xs-12 col-md-3 q-pa-xs"},ee={class:"col-xs-12 col-md-3 q-pa-xs"},oe={class:"col-xs-12 col-md-3 q-pa-xs"},le={class:"row"},te={class:"col-12"},ae=a("thead",{class:"bg-black text-white"},[a("tr",null,[a("th",null,"Opciones"),a("th",null,"Fecha"),a("th",null,"Tipo"),a("th",null,"Descripcion"),a("th",null,"Name"),a("th",null,"Total"),a("th",null,"Usuario")])],-1),se={key:0},ie={class:"text-caption",style:{"max-width":"400px","white-space":"normal","overflow-wrap":"break-word","line-height":"0.9"}},ne={class:"text-bold"},re={key:1},ce=a("tr",null,[a("td",{colspan:"7",class:"text-center"},"No hay ventas")],-1),de=[ce],ue=a("div",{class:"text-h6"},"Egreso",-1),he=a("div",{class:"text-h6"},"Ingreso Caja Chica Dia",-1),ge=a("div",{id:"myelement",class:"hidden"},null,-1);function me(l,t,pe,fe,s,r){const d=B("card2-component");return n(),u(R,{class:"q-pa-md bg-grey-3"},{default:i(()=>[o(b,null,{default:i(()=>[o(m,{class:"q-pa-xs"},{default:i(()=>[a("div",Y,[a("div",L,[o(h,{modelValue:s.fechaInicio,"onUpdate:modelValue":t[0]||(t[0]=e=>s.fechaInicio=e),label:"Fecha Inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),a("div",M,[o(h,{modelValue:s.fechaFin,"onUpdate:modelValue":t[1]||(t[1]=e=>s.fechaFin=e),label:"Fecha Fin",type:"date",outlined:"",dense:""},null,8,["modelValue"])]),a("div",z,[o(c,{label:"Buscar",color:"indigo",onClick:r.salesGet,loading:s.loading,"no-caps":"",icon:"search",class:"text-bold"},null,8,["onClick","loading"])]),a("div",H,[o(c,{label:"Caja Chica",color:"indigo",onClick:r.cajaClick,loading:s.loading,"no-caps":"",icon:"attach_money",class:"text-bold"},null,8,["onClick","loading"]),o(c,{label:"Egreso",color:"red",onClick:r.egreseClick,loading:s.loading,"no-caps":"",icon:"add_circle_outline",class:"text-bold"},null,8,["onClick","loading"])]),a("div",J,[o(d,{title:"Ingresos",subtitle:r.ingresos+" Bs.",icon:"trending_up",color:"green"},null,8,["subtitle"])]),a("div",W,[o(d,{title:"Egresos",subtitle:r.egresos+" Bs.",icon:"trending_down",color:"red"},null,8,["subtitle"])]),a("div",X,[o(d,{title:"Caja Chica",subtitle:r.totalGasto+" Bs.",icon:"fa-solid fa-cash-register",color:"blue"},null,8,["subtitle"])])]),a("div",Z,[a("div",K,[o(d,{title:"EFECTIVO",subtitle:s.ganancia1.total+" Bs.",icon:"point_of_sale",color:"amber",dense:""},null,8,["subtitle"])]),a("div",$,[o(d,{title:"TARJETA",subtitle:s.ganancia2.total+" Bs.",icon:"credit_card",color:"indigo"},null,8,["subtitle"])]),a("div",ee,[o(d,{title:"ONLINE",subtitle:s.ganancia3.total+" Bs.",icon:"shopping_cart",color:"cyan"},null,8,["subtitle"])]),a("div",oe,[o(d,{title:"QR",subtitle:s.ganancia4.total+" Bs.",icon:"qr_code_scanner",color:"deep-orange"},null,8,["subtitle"])])]),a("div",le,[a("div",te,[o(N,{dense:"","wrap-cells":""},{default:i(()=>[ae,s.sales.length>0?(n(),p("tbody",se,[(n(!0),p(S,null,U(s.sales,e=>{var x;return n(),p("tr",{key:e.id},[a("td",null,[C(g(e.numero)+" ",1),e.status!=="ANULADO"?(n(),u(A,{key:0,label:"Opciones","no-caps":"",size:"10px",dense:"",color:e.type==="EGRESO"?"red":"green","auto-close":""},{default:i(()=>[V((n(),u(D,{clickable:"",onClick:q=>r.reimprimir(e)},{default:i(()=>[o(_,{avatar:""},{default:i(()=>[o(E,{name:"print"})]),_:1}),o(_,null,{default:i(()=>[C("Reimprimir")]),_:1})]),_:2},1032,["onClick"])),[[j]]),V((n(),u(D,{clickable:"",onClick:q=>r.anular(e)},{default:i(()=>[o(_,{avatar:""},{default:i(()=>[o(E,{name:"cancel"})]),_:1}),o(_,null,{default:i(()=>[C("Anular")]),_:1})]),_:2},1032,["onClick"])),[[j]])]),_:2},1032,["color"])):f("",!0),e.status==="ANULADO"?(n(),u(v,{key:1,color:"red","text-color":"white",label:"Anulado",size:"12px",dense:""})):f("",!0)]),a("td",null,g(l.$filters.formatdMYHi(e.date+" "+e.time)),1),a("td",null,[e.type==="INGRESO"?(n(),u(v,{key:0,color:"green","text-color":"white",label:"Ingreso",size:"12px",dense:""})):f("",!0),e.type==="EGRESO"?(n(),u(v,{key:1,color:"red","text-color":"white",label:"Egreso",size:"12px",dense:""})):f("",!0)]),a("td",null,[a("div",ie,g(e.descripcion),1)]),a("td",null,g(e.name),1),a("td",ne,g(e.total)+" Bs",1),a("td",null,g((x=e.user)==null?void 0:x.name),1)])}),128))])):(n(),p("tbody",re,de))]),_:1})])])]),_:1})]),_:1}),o(y,{modelValue:s.egresoDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>s.egresoDialog=e),persistent:""},{default:i(()=>[o(b,null,{default:i(()=>[o(m,{class:"row items-center q-pb-none"},{default:i(()=>[ue,o(I),o(c,{flat:"",round:"",dense:"",icon:"close",onClick:t[2]||(t[2]=e=>s.egresoDialog=!1)})]),_:1}),o(m,null,{default:i(()=>[o(Q,{onSubmit:r.egresoPost},{default:i(()=>[o(h,{modelValue:s.egreso.total,"onUpdate:modelValue":t[3]||(t[3]=e=>s.egreso.total=e),label:"Total",type:"number",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),o(O,{modelValue:s.egreso.provedor_id,"onUpdate:modelValue":t[4]||(t[4]=e=>s.egreso.provedor_id=e),label:"Provedor",outlined:"",dense:"",options:s.provedores,"option-value":"id","option-label":"name",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","options","rules"]),o(h,{modelValue:s.egreso.descripcion,"onUpdate:modelValue":t[5]||(t[5]=e=>s.egreso.descripcion=e),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),o(k,{align:"right"},{default:i(()=>[o(c,{label:"Cancelar",color:"red",onClick:t[6]||(t[6]=e=>s.egresoDialog=!1),"no-caps":"",icon:"close",loading:s.loading},null,8,["loading"]),o(c,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:s.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(y,{modelValue:s.dialogCaja,"onUpdate:modelValue":t[12]||(t[12]=e=>s.dialogCaja=e),persistent:""},{default:i(()=>[o(b,null,{default:i(()=>[o(m,{class:"row items-center q-pb-none"},{default:i(()=>[he,o(I),o(c,{flat:"",round:"",dense:"",icon:"close",onClick:t[8]||(t[8]=e=>s.dialogCaja=!1)})]),_:1}),o(m,null,{default:i(()=>[o(Q,{onSubmit:r.cajaPost},{default:i(()=>[o(h,{modelValue:s.chica.monto,"onUpdate:modelValue":t[9]||(t[9]=e=>s.chica.monto=e),label:"Monto",type:"number",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"],step:"0.01"},null,8,["modelValue","rules"]),o(h,{modelValue:s.chica.descripcion,"onUpdate:modelValue":t[10]||(t[10]=e=>s.chica.descripcion=e),label:"Descripcion",type:"text",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),o(k,{align:"right"},{default:i(()=>[o(c,{label:"Cancelar",color:"red",onClick:t[11]||(t[11]=e=>s.dialogCaja=!1),"no-caps":"",icon:"close",loading:s.loading},null,8,["loading"]),o(c,{label:"Guardar",color:"green",type:"submit","no-caps":"",icon:"save",loading:s.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),ge]),_:1})}var Qe=F(T,[["render",me]]);export{Qe as default};
